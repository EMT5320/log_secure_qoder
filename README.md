# æ—¥å¿—é£é™©æ£€æµ‹ä¸è‡ªåŠ¨ä¿®å¤ç³»ç»Ÿ

ä¸€ä¸ªä¸“ä¸ºå®‰å…¨å›¢é˜Ÿè®¾è®¡çš„æ™ºèƒ½æ—¥å¿—åˆ†æç³»ç»Ÿï¼Œèƒ½å¤Ÿä»æœåŠ¡è¿è¡Œæ—¥å¿—ä¸­æ£€æµ‹æ½œåœ¨é£é™©ï¼ˆå¦‚SQLæ³¨å…¥ã€æ•æ„Ÿä¿¡æ¯æ³„éœ²ç­‰ï¼‰ï¼Œå¹¶åœ¨æ£€æµ‹åˆ°é£é™©æ—¶è‡ªåŠ¨è§¦å‘ä¿®å¤æ“ä½œã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

### ğŸ“ æ—¥å¿—è§£æå™¨
- **å¤šæ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒJSONã€æ™®é€šæ–‡æœ¬ã€åŠç»“æ„åŒ–å­—æ®µç­‰å¤šç§æ—¥å¿—æ ¼å¼
- **æ™ºèƒ½è§£æ**ï¼šè‡ªåŠ¨è¯†åˆ«å¹¶æå–æ—¶é—´æˆ³ã€IPåœ°å€ã€è¯·æ±‚å†…å®¹ã€é”™è¯¯ç­‰çº§ç­‰å…³é”®å­—æ®µ
- **é²æ£’æ€§å¼º**ï¼šèƒ½å¤Ÿå¤„ç†ç©ºæ—¥å¿—ã€æ ¼å¼å¼‚å¸¸ç­‰è¾¹ç¼˜æƒ…å†µ

### ğŸ” é£é™©æ£€æµ‹å¼•æ“
- **è§„åˆ™æ£€æµ‹**ï¼šå†…ç½®ä¸°å¯Œçš„æ¶æ„æ¨¡å¼æ£€æµ‹è§„åˆ™
  - SQLæ³¨å…¥æ£€æµ‹ï¼ˆUNION SELECTã€DROP TABLEã€OR 1=1ç­‰ï¼‰
  - XSSæ”»å‡»æ£€æµ‹ï¼ˆScriptæ ‡ç­¾ã€JavaScriptä¼ªåè®®ç­‰ï¼‰
  - æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼ˆé‚®ç®±ã€æ‰‹æœºå·ã€èº«ä»½è¯ã€APIå¯†é’¥ç­‰ï¼‰
  - å¼‚å¸¸è¯·æ±‚æ¨¡å¼ï¼ˆè·¯å¾„éå†ã€å‘½ä»¤æ³¨å…¥ç­‰ï¼‰

- **æœºå™¨å­¦ä¹ æ£€æµ‹**ï¼šè½»é‡çº§TF-IDF + Logistic Regressionæ¨¡å‹
  - è‡ªåŠ¨è®­ç»ƒå’Œæ›´æ–°
  - é«˜å‡†ç¡®ç‡æ¶æ„è¯·æ±‚è¯†åˆ«
  - å¯è§£é‡Šçš„æ£€æµ‹ç»“æœ

### ğŸ› ï¸ ä¿®å¤ä¸å“åº”
- **æ•æ„Ÿä¿¡æ¯è„±æ•**ï¼šè‡ªåŠ¨æ›¿æ¢æ—¥å¿—ä¸­çš„æ•æ„Ÿå­—æ®µ
- **æ™ºèƒ½å“åº”ç­–ç•¥**ï¼š
  - Criticalçº§åˆ«ï¼šé˜»æ–­è¯·æ±‚
  - Highçº§åˆ«ï¼šè„±æ•å¤„ç†
  - Medium/Lowçº§åˆ«ï¼šè®°å½•å‘Šè­¦
- **JSONæ ¼å¼å‘Šè­¦**ï¼šæ ‡å‡†åŒ–çš„å‘Šè­¦ä¿¡æ¯è¾“å‡º

### ğŸ–¥ï¸ ç³»ç»Ÿé›†æˆ
- **CLIå·¥å…·**ï¼šå‘½ä»¤è¡Œæ‰¹å¤„ç†å’Œå•æ¡æ£€æµ‹
- **REST API**ï¼šWebæœåŠ¡æ¥å£ï¼Œæ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œå®æ—¶æ£€æµ‹
- **Webç•Œé¢**ï¼šç›´è§‚çš„ç”¨æˆ·ç•Œé¢ï¼Œä¾¿äºæ¼”ç¤ºå’Œæµ‹è¯•

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.7+
- ä¾èµ–åº“è§ `requirements.txt`

### å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### åŸºæœ¬ä½¿ç”¨

#### 1. å‘½ä»¤è¡Œæ¨¡å¼

**æ£€æµ‹å•æ¡æ—¥å¿—ï¼š**
```bash
python main.py cli --text "192.168.1.1 - - [01/Jan/2024:10:00:00] \"GET /admin?id=1' OR '1'='1 HTTP/1.1\" 500 0"
```

**æ£€æµ‹æ—¥å¿—æ–‡ä»¶ï¼š**
```bash
python main.py cli --file sample_logs.log --output report.json
```

#### 2. Web APIæ¨¡å¼

**å¯åŠ¨WebæœåŠ¡ï¼š**
```bash
python main.py api --host 127.0.0.1 --port 5000
```

ç„¶åè®¿é—® `http://127.0.0.1:5000` ä½¿ç”¨Webç•Œé¢ï¼Œæˆ–è°ƒç”¨APIï¼š

```bash
# æ£€æµ‹å•æ¡æ—¥å¿—
curl -X POST http://127.0.0.1:5000/api/detect \
  -H "Content-Type: application/json" \
  -d '{"text": "SELECT * FROM users WHERE id=1 UNION SELECT password FROM admin"}'

# ä¸Šä¼ æ–‡ä»¶æ£€æµ‹
curl -X POST http://127.0.0.1:5000/api/detect-file \
  -F "file=@sample_logs.log"
```

#### 3. è®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹

```bash
python main.py train
```

### ç”Ÿæˆæ ·ä¾‹æ•°æ®

```bash
python sample_data.py
```

è¿™å°†ç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š
- `sample_logs.log` - æ··åˆæ ¼å¼çš„æ ·ä¾‹æ—¥å¿—
- `normal_logs.log` - æ­£å¸¸æ—¥å¿—æ ·ä¾‹
- `malicious_logs.log` - æ¶æ„æ—¥å¿—æ ·ä¾‹

## ğŸ“ é¡¹ç›®ç»“æ„

```
qoder/
â”œâ”€â”€ __init__.py          # åŒ…åˆå§‹åŒ–
â”œâ”€â”€ parser.py            # æ—¥å¿—è§£æå™¨æ¨¡å—
â”œâ”€â”€ detector.py          # é£é™©æ£€æµ‹æ¨¡å—
â”œâ”€â”€ responder.py         # ä¿®å¤ä¸å“åº”æ¨¡å—
â”œâ”€â”€ main.py              # ä¸»ç¨‹åºå’ŒCLI/APIæ¥å£
â”œâ”€â”€ sample_data.py       # æ ·ä¾‹æ•°æ®ç”Ÿæˆå™¨
â”œâ”€â”€ config.json          # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt     # ä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md           # è¯´æ˜æ–‡æ¡£
```

## âš™ï¸ é…ç½®è¯´æ˜

ç¼–è¾‘ `config.json` æ–‡ä»¶æ¥è‡ªå®šä¹‰ç³»ç»Ÿè¡Œä¸ºï¼š

```json
{
  "logging": {
    "level": "INFO",
    "file": "log_security.log"
  },
  "ml_model": {
    "auto_train": true,
    "model_path": "ml_detector_model.pkl"
  },
  "responder": {
    "auto_sanitize": true,
    "response_rules": {
      "critical": "block",
      "high": "sanitize",
      "medium": "log",
      "low": "log"
    }
  }
}
```

## ğŸ“Š ç¤ºä¾‹è¾“å…¥è¾“å‡º

### è¾“å…¥ç¤ºä¾‹

**æ¶æ„SQLæ³¨å…¥æ—¥å¿—ï¼š**
```
{"timestamp": "2024-01-01T10:00:00Z", "ip": "192.168.1.100", "level": "ERROR", "message": "SELECT * FROM users WHERE id=1 UNION SELECT password FROM admin"}
```

**æ•æ„Ÿä¿¡æ¯æ³„éœ²æ—¥å¿—ï¼š**
```
2024-01-01 10:01:00 INFO [192.168.1.101] User registration: email=test@example.com phone=13812345678
```

### è¾“å‡ºç¤ºä¾‹

**æ£€æµ‹ç»“æœï¼š**
```json
{
  "success": true,
  "risk_result": {
    "is_risk": true,
    "risk_type": "sql_injection",
    "risk_level": "high",
    "confidence": 0.95,
    "matched_rules": ["sql_injection.union_select"]
  },
  "alert": {
    "level": "high",
    "ip": "192.168.1.100",
    "action": "sanitize",
    "reason": "SQL Injection; Rules: sql_injection.union_select",
    "timestamp": "2024-01-01T10:00:00",
    "sanitized_content": "SELECT * FROM users WHERE id=1 UNION SELECT *** FROM ***"
  }
}
```

## ğŸ”§ é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰æ£€æµ‹è§„åˆ™

åœ¨ `detector.py` ä¸­çš„è§„åˆ™é…ç½®ä¸­æ·»åŠ æ–°è§„åˆ™ï¼š

```python
self.custom_rules = {
    'my_rule': {
        'pattern': r'my_pattern',
        'flags': re.IGNORECASE,
        'level': 'high',
        'description': 'è‡ªå®šä¹‰è§„åˆ™æè¿°'
    }
}
```

### æ‰©å±•è„±æ•è§„åˆ™

åœ¨ `responder.py` ä¸­æ·»åŠ æ–°çš„è„±æ•æ¨¡å¼ï¼š

```python
self.patterns['new_sensitive_data'] = {
    'pattern': r'your_regex_pattern',
    'replacement': '***'
}
```

## ğŸ“ˆ æ€§èƒ½ç‰¹ç‚¹

- **å¤„ç†é€Ÿåº¦**ï¼šå•æ¡æ—¥å¿—æ£€æµ‹ < 10ms
- **å†…å­˜å ç”¨**ï¼šåŸºç¡€è¿è¡Œçº¦50MB
- **å‡†ç¡®ç‡**ï¼šè§„åˆ™æ£€æµ‹99%+ï¼ŒMLæ£€æµ‹90%+
- **æ”¯æŒå¹¶å‘**ï¼šWeb APIæ”¯æŒå¤šç”¨æˆ·åŒæ—¶è®¿é—®

## ğŸ›¡ï¸ å®‰å…¨è€ƒè™‘

- æ•æ„Ÿä¿¡æ¯è‡ªåŠ¨è„±æ•å¤„ç†
- å‘Šè­¦ä¿¡æ¯å®‰å…¨å­˜å‚¨
- æ”¯æŒè®¿é—®æ§åˆ¶å’Œå®¡è®¡æ—¥å¿—
- æ£€æµ‹ç»“æœå¯è¿½æº¯

## ğŸ”„ ç³»ç»Ÿç»´æŠ¤

### æ—¥å¿—æ–‡ä»¶ç®¡ç†
- `log_security.log` - ç³»ç»Ÿè¿è¡Œæ—¥å¿—
- `security_alerts.log` - å®‰å…¨å‘Šè­¦è®°å½•

### æ¨¡å‹æ›´æ–°
å®šæœŸé‡æ–°è®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹ä»¥æé«˜æ£€æµ‹å‡†ç¡®ç‡ï¼š

```bash
python main.py train
```

### å‘Šè­¦å¯¼å‡º
```python
from responder import RiskResponseSystem
system = RiskResponseSystem()
system.export_alerts('alerts_export.json', format='json')
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤å˜æ›´
4. å‘èµ·Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäºMITè®¸å¯è¯å¼€æºã€‚

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- é¡¹ç›®åœ°å€ï¼š[GitHubä»“åº“é“¾æ¥]
- é—®é¢˜åé¦ˆï¼š[Issuesé¡µé¢]
- æŠ€æœ¯æ–‡æ¡£ï¼š[Wikié¡µé¢]

---

**æ³¨æ„**ï¼šæœ¬ç³»ç»Ÿä»…ç”¨äºå®‰å…¨é˜²æŠ¤ç›®çš„ï¼Œè¯·åœ¨åˆæ³•åˆè§„çš„ç¯å¢ƒä¸­ä½¿ç”¨ã€‚